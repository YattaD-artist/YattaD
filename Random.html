<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tiêu Chuẩn</title>

<!-- Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Saira:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
/* ===== Global Reset & Variables ===== */
* { box-sizing: border-box; margin:0; padding:0; }
html, body { max-width: 100%; overflow-x: hidden; font-family: 'Saira', sans-serif; }
:root {
  --bg: #ede9eb; --text: #1a2129; --accent: #e32630;
}
body.dark { --bg: #1b1b1b; --text: #f5f5f5; --accent: #1cd9cf; }
body { background-color: var(--bg); color: var(--text); transition: 0.3s; }

/* ===== Header ===== */
header {
  display:flex; justify-content:space-between; align-items:center;
  padding:12px 24px; border-bottom:1px solid #ccc; background-color:var(--bg);
  position:sticky; top:0; z-index:100; box-shadow:0 2px 8px rgba(0,0,0,0.1);
}
.center-title { flex:1; text-align:center; font-weight:800; font-size:2.5rem; color:var(--accent); }
.left, .right { display:flex; align-items:center; gap:16px; }
.icon-btn {
  background:none; border:none; cursor:pointer; font-size:1.3rem; color:var(--text);
  width:38px; height:38px; border-radius:50%; display:flex; align-items:center; justify-content:center;
  transition: transform 0.25s, color 0.25s, background-color 0.25s; text-decoration:none;
}
.icon-btn:hover { transform: scale(1.15); color:var(--accent); background-color: rgba(0,0,0,0.05); }

/* ===== Main Layout ===== */
main { display:flex; flex-direction:column; gap:24px; padding:20px 30px; }
#centerContainer { display:flex; gap:20px; width:100%; }
.left-column { flex:1; display:flex; flex-direction:column; gap:12px; }

/* ===== Info Box ===== */
.info {
  padding:16px; background-color:var(--bg); border-radius:12px;
  border:1px solid rgba(0,0,0,0.1); box-shadow:0 4px 12px rgba(0,0,0,0.05);
}
.info h2 { font-size:1.6rem; margin-bottom:12px; color:var(--accent); }
.info p { font-size:0.9rem; margin-bottom:8px; }

/* ===== Input / Select / Textarea ===== */
.left-panel textarea,
.left-panel input[type="number"],
.left-panel select {
  border: 2px solid var(--text); border-radius:12px; padding:10px 12px; font-size:1rem;
  background-color:var(--bg); color:var(--text); box-sizing:border-box; appearance:none;
}
.left-panel textarea { width:100%; height:140px; resize:vertical; }
.left-panel input[type="number"], .left-panel select { width:80px; height:38px; min-width:60px; }
.left-panel input[type="number"]:focus,
.left-panel select:focus,
.left-panel textarea:focus { border-color:var(--accent); outline:none; box-shadow:0 4px 12px rgba(0,0,0,0.1); }

/* ===== Options Section ===== */
.options { display:flex; flex-direction:column; gap:10px; }
.options label { display:flex; align-items:center; gap:8px; }

/* ===== Spin Button ===== */
#spinBtn {
  display:block; width:70%; padding:12px 0; margin:24px auto 0;
  font-size:1rem; font-weight:600; border-radius:12px; border:2px solid var(--accent);
  background-color:var(--bg); color:var(--accent); cursor:pointer; transition:all 0.25s ease;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
}
#spinBtn:hover {
  background-color: var(--accent); color:var(--bg);
  transform: translateY(-2px); box-shadow:0 6px 12px rgba(0,0,0,0.15);
}

/* ===== Right Panel / Wheel ===== */
.right-panel { flex:1; display:flex; justify-content:center; align-items:flex-start; }
#wheelContainer {
  position: relative; width:100%; max-width: 470px; aspect-ratio: 1 / 1; /* giữ tỉ lệ vuông */ margin-top:40px;
  border-radius:50%; border:6px solid var(--accent); box-shadow:0 8px 20px rgba(0,0,0,0.3);
  display:flex; justify-content:center; align-items:center; background:var(--bg);
}
#wheelCanvas { width: 95%; /* tự động scale theo container */ height: 95%;
}
#centerImg { position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); width:auto; max-width:45%; height: auto; border-radius:50%; }

/* ===== Result Popup ===== */
#resultOverlay, #lotteryOverlay, #abcdOverlay {
  position:fixed; top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.5); display:none; align-items:center; justify-content:center; z-index:999;
}
#resultPopup, #lotteryPopup, #abcdPopup {
  background:white; color:black; padding:20px 24px; border-radius:12px;
  box-shadow:0 4px 16px rgba(0,0,0,0.4); min-width:200px; text-align:center;
  animation:popscale 0.3s ease;
}
#resultPopup h3, #lotteryPopup h3, #abcdPopup h3 { margin-top:0; color:var(--accent); }
#resultPopup button, #lotteryPopup button, #abcdPopup button {
  margin-top:12px; padding:8px 14px; border:none; background:var(--accent); color:white;
  border-radius:8px; cursor:pointer; font-weight:600; transition:all 0.25s ease;
}
#resultPopup button:hover, #lotteryPopup button:hover, #abcdPopup button:hover {
  transform: translateY(-2px); box-shadow:0 6px 12px rgba(0,0,0,0.15);
}
@keyframes popscale { from { transform:scale(0.7); opacity:0; } to { transform:scale(1); opacity:1; } }

/* ===== Lottery Numbers ===== */
.lotteryNumber {
  width:50px; height:50px; border-radius:50%; display:flex;
  justify-content:center; align-items:center; font-weight:700; font-size:1.2rem;
  border:2px solid var(--text);
}
.lotteryNumber.lotteryLucky { background: var(--accent); color:#fff; }
.lotteryNumber.lotteryMain { background: var(--bg); color: var(--text); }

/* ===== ABCD Cells ===== */
.abcdCell {
  border:2px solid var(--text); border-radius:8px; padding:6px;
  background: var(--bg); font-weight:600; color: var(--text); text-align:center;
}

/* ===== Menu ===== */
.menu { display:grid; grid-template-columns:repeat(auto-fit,minmax(150px,1fr)); gap:18px; margin-top:100px; }
.menuItem { cursor:pointer; text-align:center; border:2px solid var(--text); border-radius:12px; padding:8px; transition: transform 0.25s, box-shadow 0.25s; }
.menuItem img { width:100%; border-radius:8px; margin-bottom:6px; }
.menuItem:hover { transform:translateY(-3px); box-shadow:0 6px 12px rgba(0,0,0,0.15); border-color:var(--accent); }

/* ===== Responsive ===== */
@media(max-width:768px){
   #centerContainer { flex-direction: column; }
    .right-panel { justify-content: center; margin-top: 16px; }
     /* Menu trên mobile: 1 cột */
    .menu { display: flex; flex-direction: column; gap: 12px; margin-top: 40px; /* cho thoáng */ }
    .menuItem {width: 100%; /* full chiều ngang */}
  .options { flex-direction:column; gap:10px; }
}
</style>
</head>

<body>
<header>
  <div class="left"><a href="index.html" class="icon-btn" title="Trang chủ"><i class="fas fa-home"></i></a></div>
  <div class="center-title" id="title">TIÊU CHUẨN</div>
  <div class="right">
    <button class="icon-btn" id="theme-toggle" title="Đổi chế độ"><i class="fas fa-adjust"></i></button>
    <button class="icon-btn" id="lang-toggle" title="Đổi ngôn ngữ"><i class="fa-solid fa-language"></i></button>
  </div>
</header>

<main>
<div id="centerContainer">
  <!-- Left Column -->
  <div class="left-column">
    <div class="info">
      <h2 id="introTitle">Giới Thiệu</h2>
      <p id="introP1">Đây là trang Tiêu Chuẩn – nơi cung cấp thông tin cơ bản và rõ ràng.</p>
      <p id="introP2">Hãy điền tên vào bảng để Tiêu chọn, hoặc thử những tiên đoán khác của Tiêu.</p>
    </div>

    <div class="left-panel">
      <h3>Danh sách tên</h3>
      <textarea id="nameInput">Tiêu
Chọn
Thì
Chỉ
Có
Chuẩn</textarea>

      <div class="options">
        <label><span id="repeat">Số lần lặp:</span>
          <select id="repeatSelect">
            <option value="1">1</option><option value="2">2</option><option value="3">3</option>
            <option value="4">4</option><option value="5">5</option>
          </select>
        </label>

        <label><span id="spin">Thời gian quay:</span>
          <select id="durationSelect">
            <option value="3000">3s</option><option value="4000">4s</option>
            <option value="5000">5s</option><option value="6000">6s</option>
            <option value="7000">7s</option><option value="8000">8s</option>
            <option value="9000">9s</option><option value="10000">10s</option>
            <option value="11000">11s</option><option value="12000">12s</option>
          </select>
        </label>
      </div>

      <button id="spinBtn">Quay</button>
    </div>
  </div>

  <!-- Right Column -->
  <div class="right-panel">
    <div id="wheelContainer">
      <canvas id="wheelCanvas" width="400" height="400"></canvas>
      <img id="centerImg" src="assets/Tieuchuan/Tieu.webp" alt="Tiêu">
    </div>
  </div>
</div>

<!-- Popups -->
<div id="resultOverlay">
  <div id="resultPopup">
    <h3>Kết quả</h3>
    <div id="resultText"></div>
    <button onclick="closePopup()">Đóng</button>
  </div>
</div>

<div id="lotteryOverlay">
  <div id="lotteryPopup">
    <h3 id="lotteryTitle"></h3>
    <div id="lotteryNumbers" style="display:flex; justify-content:center; gap:10px; flex-wrap:wrap;"></div>
    <button onclick="closeLottery()">Đóng</button>
  </div>
</div>

<div id="abcdOverlay">
  <div id="abcdPopup">
    <h3>ABCD Random</h3>
    <p>Nhập số lượng câu hỏi (tối đa 50):</p>
    <input type="number" id="abcdCount" min="1" max="50">
    <br>
    <button id="abcdStart">BẮT ĐẦU</button>
    <div id="abcdResult" style="margin-top:16px; display:grid; grid-template-columns:repeat(auto-fill, minmax(60px,1fr)); gap:8px;"></div>
    <button onclick="closeABCD()">Đóng</button>
  </div>
</div>

<!-- Menu -->
<div class="menu">
  <div id="menu1" class="menuItem"><p>Vietlott Mega</p><img src="assets/Tieuchuan/mega.webp"></div>
  <div id="menu2" class="menuItem"><p>Vietlott Power</p><img src="assets/Tieuchuan/power.webp"></div>
  <div id="menu3" class="menuItem"><p>ABCD</p><img src="assets/Tieuchuan/abcd.webp"></div>
</div>
</main>

<script>
// ===== Theme Toggle =====
const themeBtn = document.getElementById('theme-toggle');
themeBtn.addEventListener('click', () => {
  document.body.classList.toggle('dark');
  localStorage.setItem('theme', document.body.classList.contains('dark')?'dark':'light');
});
if(localStorage.getItem('theme')==='dark') document.body.classList.add('dark');

// ===== Language Toggle =====
const langBtn = document.getElementById('lang-toggle');
let currentLang = localStorage.getItem('lang')||'vi';
const translations = {
  vi:{ title:"Tiêu Chuẩn", introTitle:"Giới Thiệu", introP1:"Đây là trang Tiêu Chuẩn – nơi cung cấp thông tin cơ bản và rõ ràng.", introP2:"Hãy điền tên vào bảng để Tiêu chọn, hoặc thử những tiên đoán khác của Tiêu.", repeat:"Số lần lặp", spin:"Thời gian quay", spinBtn:"Quay", menu1:"Vietlott Mega", menu2:"Vietlott Power", menu3:"ABCD", resultText:"Kết quả" },
  en:{ title:"Standard", introTitle:"Introduction", introP1:"This is the Standard page – providing simple and clear information.", introP2:"Please enter a name in the table for Tiêu to choose, or try Tiêu's other predictions.", repeat:"Iterations", spin:"Spin time", spinBtn:"Spin", menu1:"Vietlott Mega", menu2:"Vietlott Power", menu3:"ABCD", resultText:"Result" }
};
function switchLanguage(){
  currentLang = currentLang==='vi'?'en':'vi';
  localStorage.setItem('lang',currentLang);
  for(const key in translations[currentLang]){
    const el = document.getElementById(key);
    if(el){
      if(key.startsWith('menu')){
        const p = el.querySelector('p'); if(p) p.textContent=translations[currentLang][key];
      } else el.innerHTML=translations[currentLang][key];
    }
  }
}
langBtn.addEventListener('click', switchLanguage);
document.addEventListener('DOMContentLoaded',()=>{if(currentLang==='en') switchLanguage();});

// ===== Wheel =====
const canvas = document.getElementById("wheelCanvas");
const ctx = canvas.getContext("2d");
const nameInput = document.getElementById("nameInput");
const repeatSelect = document.getElementById("repeatSelect");
const durationSelect = document.getElementById("durationSelect");
const spinBtn = document.getElementById("spinBtn");
const overlay = document.getElementById("resultOverlay");
const resultText = document.getElementById("resultText");

let names=[], angle=0, spinning=false;
const colors = ["#ffc7cf","#da526e","#cb4c43","#fce5d7","#ff7361","#ce7869","#e55033","#f8898e","#eb4747","#fd613a","#dd7e57"];

function updateNames(){
  const raw = nameInput.value.split("\n").map(x=>x.trim()).filter(x=>x);
  const repeat = Math.min(+repeatSelect.value||1,5);
  names = [];
  for(let i=0;i<repeat;i++){
    names.push(...raw); // lặp toàn bộ danh sách
  }
  drawWheel();
}

function drawWheel(){
  const radius = canvas.width/2;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const grad = ctx.createRadialGradient(radius,radius,10,radius,radius,radius);
  grad.addColorStop(0,"#fff"); grad.addColorStop(1,"#e0e0e0");
  ctx.fillStyle = grad; ctx.beginPath(); ctx.arc(radius,radius,radius,0,2*Math.PI); ctx.fill();
  if(names.length===0){ ctx.fillStyle="gray"; ctx.beginPath(); ctx.arc(radius,radius,radius,0,2*Math.PI); ctx.fill(); return; }
  const arc = 2*Math.PI/names.length;
  names.forEach((n,i)=>{
    const start = angle + i*arc;
    ctx.beginPath(); ctx.moveTo(radius,radius); ctx.fillStyle=colors[i%colors.length]; ctx.arc(radius,radius,radius,start,start+arc); ctx.fill();
    ctx.save(); ctx.translate(radius,radius); ctx.rotate(start+arc/2); ctx.fillStyle="black"; ctx.font="16px Saira"; ctx.textAlign="right"; ctx.fillText(n, radius-10,5); ctx.restore();
  });
}

// ===== Spin Wheel with duration =====
function spinWheel(){
  if(spinning||names.length===0) return;
  spinning=true;
  const duration = parseInt(durationSelect.value); // ms
  const totalRotation = Math.random()*2*Math.PI + 10*2*Math.PI;
  const startAngle = angle;
  const startTime = performance.now();
  
  function animate(now){
    const elapsed = now - startTime;
    const t = Math.min(elapsed/duration,1);
    angle = startAngle + totalRotation*(1 - (1-t)*(1-t)); // ease out quadratic
    drawWheel();
    if(t<1) requestAnimationFrame(animate);
    else { spinning=false; showResult(); }
  }
  requestAnimationFrame(animate);
}

function showResult(){
  const arc=2*Math.PI/names.length;
  const normalized=(2*Math.PI-(angle % (2*Math.PI)))%(2*Math.PI);
  const index=Math.floor(normalized/arc);
  resultText.textContent=names[index]||"Không có tên";
  overlay.style.display="flex";
}

function closePopup(){ overlay.style.display="none"; }
overlay.addEventListener('click',(e)=>{if(e.target===overlay) closePopup();});
nameInput.addEventListener("input",updateNames);
repeatSelect.addEventListener("change",updateNames);
durationSelect.addEventListener("change",updateNames);
spinBtn.addEventListener("click",spinWheel);
updateNames();

// ===== Vietlott =====
const lotteryOverlay = document.getElementById('lotteryOverlay');
const lotteryPopup = document.getElementById('lotteryPopup');
const lotteryTitle = document.getElementById('lotteryTitle');
const lotteryNumbers = document.getElementById('lotteryNumbers');

function generateNumbers(count,max){ const set=new Set(); while(set.size<count) set.add(Math.floor(Math.random()*max)+1); return Array.from(set);}
function generateLuckyNumber(main,max){ let n; do{n=Math.floor(Math.random()*max)+1;}while(main.includes(n)); return n;}
function saveLottery(key,data){ const expiry=Date.now()+30*60*1000; localStorage.setItem(key,JSON.stringify({numbers:data,expiry})); }
function loadLottery(key){ const item=localStorage.getItem(key); if(!item) return null; const parsed=JSON.parse(item); if(Date.now()>parsed.expiry){ localStorage.removeItem(key); return null;} return parsed.numbers; }

function showLottery(type){
  let key,max;
  if(type==='mega'){key='megaNumbers'; max=45; lotteryTitle.textContent='Vietlott Mega';}
  if(type==='power'){key='powerNumbers'; max=55; lotteryTitle.textContent='Vietlott Power';}
  let numbers = loadLottery(key);
  if(!numbers){ const main=generateNumbers(6,max); const lucky=generateLuckyNumber(main,max); numbers=[...main,lucky]; saveLottery(key,numbers);}
  lotteryNumbers.innerHTML='';
  numbers.forEach((n,i)=>{const div=document.createElement('div'); div.textContent=n; div.className='lotteryNumber '+(i===6?'lotteryLucky':'lotteryMain'); lotteryNumbers.appendChild(div);});
  lotteryOverlay.style.display='flex';
}
function closeLottery(){ lotteryOverlay.style.display='none'; }
lotteryOverlay.addEventListener('click',(e)=>{if(e.target===lotteryOverlay) closeLottery();});
document.getElementById('menu1').addEventListener('click',()=>showLottery('mega'));
document.getElementById('menu2').addEventListener('click',()=>showLottery('power'));

// ===== ABCD =====
const abcdOverlay=document.getElementById('abcdOverlay');
const abcdStartBtn=document.getElementById('abcdStart');
const abcdCountInput=document.getElementById('abcdCount');
const abcdResultDiv=document.getElementById('abcdResult');

function showABCD(){ abcdCountInput.value=''; abcdResultDiv.innerHTML=''; abcdOverlay.style.display='flex'; }
function closeABCD(){ abcdOverlay.style.display='none'; }

function generateABCD(n){ const answers=['A','B','C','D']; const results=[]; for(let i=1;i<=n;i++){ results.push({stt:i, ans:answers[Math.floor(Math.random()*4)]}); } return results; }

abcdStartBtn.addEventListener('click',()=>{
  let n = Math.min(Math.max(parseInt(abcdCountInput.value)||1,1),50);
  const results=generateABCD(n); abcdResultDiv.innerHTML='';
  results.forEach(r=>{ const div=document.createElement('div'); div.className='abcdCell'; div.textContent=`${r.stt}: ${r.ans}`; abcdResultDiv.appendChild(div); });
});
abcdOverlay.addEventListener('click',(e)=>{if(e.target===abcdOverlay) closeABCD();});
document.getElementById('menu3').addEventListener('click', showABCD);
</script>
</body>
</html>
