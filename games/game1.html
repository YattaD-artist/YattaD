<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Horizontal Flappy Bird - Styled</title>
<link href="https://fonts.googleapis.com/css2?family=Chewy&display=swap" rel="stylesheet">
<style>
  :root{
    --bg-light: #ede9eb;
    --panel-dark: #1a2129;
    --accent: #e32630;
    --muted: #f4f4f4;
    --card: #ffffff;
    --radius: 14px;
    --shadow: 0 8px 24px rgba(26,33,41,0.12);
  }
  html,body{height:100%; margin:0; background:var(--bg-light); font-family:'Chewy', cursive;}
  .page {min-height:100vh; display:flex; align-items:center; justify-content:center; padding:28px; gap:20px;}
  .panel {
    width:180px; background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow);
    padding:14px; color:var(--panel-dark);
  }
  .panel h3{margin:0 0 10px 0; font-size:18px; text-align:center;}
  label{display:block; font-size:13px; margin:10px 0 6px;}
  select{
    width:100%; padding:8px; border-radius:10px; border:1px solid rgba(0,0,0,0.06);
    background: linear-gradient(180deg, #fff, #fbfbfb); font-family:inherit; font-size:13px;
  }
  ul#scoreList{ margin:8px 0 0 0; padding-left:18px; font-size:14px; }
  ul#scoreList li{ margin:6px 0; }

  .game-card{
    width:420px; background:var(--panel-dark); border-radius:20px; padding:18px;
    box-shadow:var(--shadow); display:flex; flex-direction:column; align-items:center; gap:12px;
    position:relative;
  }
  .top-row{width:100%; display:flex; justify-content:space-between; align-items:center;}
  #score {color:var(--muted); font-size:22px; background:rgba(255,255,255,0.08);
    padding:8px 14px; border-radius:12px; min-width:70px; text-align:center;}

  .canvas-wrap{ background: linear-gradient(180deg, #e9edf0, #ffffff); border-radius:12px; padding:12px; position:relative;}
  canvas{ display:block; border-radius:10px; background:#70c5ce; width:400px; height:600px;
    box-shadow:0 18px 40px rgba(0,0,0,0.12); }

  .controls{ display:flex; gap:12px; margin-top:10px; }
  .btn{
    flex:1; background:var(--accent); color:#fff; border:none; border-radius:12px;
    padding:10px; font-size:16px; cursor:pointer; box-shadow:0 6px 14px rgba(227,38,48,0.2);
  }
  .btn:active{ transform:translateY(1px); }

  #gameOver{
    display:none; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    background:rgba(255,255,255,0.95); padding:30px 40px; border-radius:16px;
    font-size:24px; color:var(--accent); text-align:center; box-shadow:var(--shadow);
  }
  @media(max-width:980px){ .page{flex-direction:column; padding:18px;} .panel,.game-card{width:90%; max-width:420px;} }
</style>
</head>
<body>
<div class="page">
  <!-- Left settings -->
  <div class="panel">
    <h3>Settings</h3>
    <label>Character Skin</label>
    <select id="charSkin">
      <option value="yellow">Yellow</option><option value="red">Red</option>
      <option value="blue">Blue</option><option value="purple">Purple</option>
    </select>
    <label>Pipe Color</label>
    <select id="pipeSkin">
      <option value="green">Green</option><option value="darkgreen">Dark Green</option>
      <option value="orange">Orange</option><option value="brown">Brown</option>
    </select>
    <label>Background</label>
    <select id="bgSkin">
      <option value="#70c5ce">Sky Blue</option><option value="#ffe066">Yellow</option>
      <option value="#c0e0de">Mint</option><option value="#f0b0c0">Pink</option>
    </select>
  </div>

  <!-- Game center -->
  <div class="game-card">
    <div class="top-row">
      <div style="color:var(--muted); font-size:13px;">Press Space / Click / Touch</div>
      <div id="score">0</div>
    </div>
    <div class="canvas-wrap">
      <canvas id="gameCanvas" width="400" height="600"></canvas>
      <div id="gameOver">Game Over</div>
    </div>
    <div class="controls">
      <button id="mainBtn" class="btn">Start</button>
    </div>
  </div>

  <!-- Right history -->
  <div class="panel">
    <h3>Score History</h3>
    <ul id="scoreList"></ul>
  </div>
</div>

<script>
const canvas=document.getElementById('gameCanvas'),ctx=canvas.getContext('2d');
let bird,pipes,frame,score,gameOver,paused,loopId;
let pipeHeight=50,gapWidth=120,pipeSpeed=2;
let historyScores=[],charColor='yellow',pipeColor='green',bgColor='#70c5ce';

function init(){
  bird = {x:50,y:300,width:25,height:30,speed:2,direction:1,angle:0};
  pipes=[]; frame=0; score=0; gameOver=false; paused=false;
  pipeSpeed=2; gapWidth=120; loopId=null;
  document.getElementById('score').textContent=score;
  document.getElementById('gameOver').style.display='none';
  canvas.style.background=bgColor;
}
function createPipe(){
  const gapX=Math.floor(Math.random()*(canvas.width-gapWidth-50))+25;
  pipes.push({y:0,height:pipeHeight,gapX:gapX});
}

function drawBird(){
  ctx.save();
  // di chuyển gốc tọa độ tới tâm bird
  ctx.translate(bird.x + bird.width/2, bird.y + bird.height/2);
  ctx.rotate(bird.angle); // xoay theo góc
  ctx.fillStyle = charColor;

  // vẽ tam giác cân thay vì hình vuông
  ctx.beginPath();
  ctx.moveTo(0, -bird.height/2);          // đỉnh trên
  ctx.lineTo(-bird.width/2, bird.height/2); // góc trái
  ctx.lineTo(bird.width/2, bird.height/2);  // góc phải
  ctx.closePath();
  ctx.fill();

  ctx.restore();
}

function drawPipes(){ctx.fillStyle=pipeColor;
  for(const p of pipes){
    ctx.fillRect(0,p.y,p.gapX,p.height);
    ctx.fillRect(p.gapX+gapWidth,p.y,canvas.width-(p.gapX+gapWidth),p.height);
  }
}
function update(){
  bird.x+=bird.speed*bird.direction;
  bird.angle = bird.direction * Math.min(0.6, bird.speed * 0.3); 
  if(bird.x<0||bird.x+bird.width>canvas.width){endGame();return;}
  for(const p of pipes){
    p.y+=pipeSpeed;
    if(bird.y<p.y+p.height&&bird.y+bird.height>p.y&&(bird.x<p.gapX||bird.x+bird.width>p.gapX+gapWidth)){endGame();return;}
    if(!p.passed&&p.y>bird.y+bird.height){score++;pipeSpeed=Math.min(5,pipeSpeed+0.012);bird.speed=Math.min(4,bird.speed+0.005);p.passed=true;
      document.getElementById('score').textContent=score;}
  }
  if(pipes.length&&pipes[0].y>=canvas.height)pipes.shift();
  if(frame%90===0)createPipe();
  frame++;
}
function render(){ctx.clearRect(0,0,canvas.width,canvas.height);drawBird();drawPipes();}
function loop(){if(gameOver||paused)return;update();render();loopId=requestAnimationFrame(loop);}
function flap(){if(gameOver||paused)return;bird.direction*=-1;}
function endGame(){
  gameOver=true;
  document.getElementById('gameOver').style.display='block';
  document.getElementById('mainBtn').textContent="Restart";
}
function pushScore(){if(score>0){historyScores.push(score);updateHistory();}}
function updateHistory(){const ul=document.getElementById('scoreList');ul.innerHTML='';
  historyScores.slice().reverse().forEach((s,i)=>{const li=document.createElement('li');li.textContent=`#${historyScores.length-i}: ${s}`;ul.appendChild(li);});
}

// Main button
document.getElementById('mainBtn').onclick=()=>{
  const btn=document.getElementById('mainBtn');
  if(btn.textContent==="Start"){ // Start game
    init(); loop(); btn.textContent="Pause";
  }
  else if(btn.textContent==="Pause"){ // Pause game
    paused=true; btn.textContent="Resume";
  }
  else if(btn.textContent==="Resume"){ // Resume game
    paused=false; loop(); btn.textContent="Pause";
  }
  else if(btn.textContent==="Restart"){ // Restart after game over
    pushScore(); init(); loop(); btn.textContent="Pause";
  }
};
document.addEventListener('keydown',e=>{if(e.code==='Space')flap();});
canvas.addEventListener('click',flap);
canvas.addEventListener('touchstart',e=>{e.preventDefault();flap();});

// Settings
document.getElementById('charSkin').onchange=e=>charColor=e.target.value;
document.getElementById('pipeSkin').onchange=e=>pipeColor=e.target.value;
document.getElementById('bgSkin').onchange=e=>{bgColor=e.target.value;canvas.style.background=bgColor;};

//Sóng
// --- Hiệu ứng sóng nước ---
let ripples=[];

function drawRipples(){
  for(let i=ripples.length-1;i>=0;i--){
    let r=ripples[i];
    ctx.beginPath();
    ctx.arc(r.x,r.y,r.radius,0,Math.PI*2);
    ctx.strokeStyle=`rgba(255,255,255,${r.alpha})`;
    ctx.lineWidth=2;
    ctx.stroke();
    r.radius+=1.5; // lan rộng
    r.alpha-=0.02; // mờ dần
    if(r.alpha<=0) ripples.splice(i,1);
  }
}

function addRipple(x,y){
  ripples.push({x,y,radius:0,alpha:0.6});
}

// chèn vào render gốc
const oldRender = render;
render = function(){
  oldRender();
  drawRipples();
};

// bắt sự kiện click/touch/space để tạo ripple
canvas.addEventListener('click',e=>{
  const rect=canvas.getBoundingClientRect();
  addRipple(e.clientX-rect.left,e.clientY-rect.top);
});
canvas.addEventListener('touchstart',e=>{
  const rect=canvas.getBoundingClientRect();
  const t=e.touches[0];
  addRipple(t.clientX-rect.left,t.clientY-rect.top);
});
document.addEventListener('keydown',e=>{
  if(e.code==='Space'){
    addRipple(bird.x+bird.width/2,bird.y+bird.height/2);
  }
});

//THÊM

</script>
</body>
</html>
